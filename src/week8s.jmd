# MATH50003 Numerical Analysis: Problem Sheet 8

This problem sheet explores the Discrete Fourier Transform (DFT),
the Fast Fourier Transform (FFT), and orthogonal polynomials,

Questions marked with a ‚ãÜ are meant to be completed without using a computer.
Problems are denoted A/B/C to indicate their difficulty.


```julia
using LinearAlgebra, Plots, Test
```



## 1. DFT

**Problem 1.1‚ãÜ (C)** Show that the DFT $Q_n$ is symmetric ($Q_n = Q_n^‚ä§$) but not Hermitian ($Q_n ‚â†¬†Q_n^‚ãÜ$).

**Problem 1.2‚ãÜ (A)** Show for $0 ‚â§¬†k,‚Ñì ‚â§¬†n-1$
$$
{1 \over n} \sum_{j=1}^n \cos k Œ∏_j \cos ‚Ñì Œ∏_j = \begin{cases} 1 & k = ‚Ñì = 0 \\
                                                  1/2 & k = ‚Ñì \\
                                                  0 & \hbox{otherwise}
                                                  \end{cases}
$$
for $Œ∏_j = œÄ(j-1/2)/n$. Hint: Be careful as the $\theta_j$ differ from before, 
and only cover half the period, $[0,\pi]$. Using symmetry may help.
You may also consider replacing $\cos$ with 
complex exponentials:
$$
\cos Œ∏ = {{\rm e}^{{\rm i}Œ∏} + {\rm e}^{-{\rm i}Œ∏} \over 2}.
$$


**SOLUTION**
We have
$$
{1 \over n} \sum_{j=1}^n \cos k Œ∏_j \cos ‚Ñì Œ∏_j = Œ£_n[{\rm e}^{{\rm i} (k+‚Ñì) Œ∏_j}] + 
Œ£_n[{\rm e}^{{\rm i} (k-‚Ñì) Œ∏_j}] + 
Œ£_n[{\rm e}^{{\rm i} (‚Ñì-k) Œ∏_j}] + Œ£_n[{\rm e}^{{\rm i} (-k-‚Ñì) Œ∏_j}] = 
\begin{cases}
1 & k+ \\
0
\end{cases}
$$

**END**

**Problem 1.3‚ãÜ (B)** Consider the Discrete Cosine Transform (DCT)
$$
C_n := \begin{bmatrix}
\sqrt{1/n} \\
 & \sqrt{2/n} \\ 
 && ‚ã± \\
 &&& \sqrt{2/n}
 \end{bmatrix}
\begin{bmatrix}
    1 & ‚ãØ & 1\\
    \cos Œ∏_1 & ‚ãØ & \cos Œ∏_n \\
    ‚ãÆ & ‚ã± & ‚ãÆ \\
    \cos (n-1)Œ∏_1 & ‚ãØ & \cos (n-1)Œ∏_n
\end{bmatrix}
$$
for $Œ∏_j = œÄ(j-1/2)/n$. Prove that $C_n$ is orthogonal: $C_n^‚ä§ C_n = C_n C_n^‚ä§ = I$.
Hint: $C_n C_n^‚ä§ = I$ might be easier to show than $C_n^‚ä§ C_n = I$ using the previous problem.




**SOLUTION**

For 
$$
\begin{bmatrix}
    1 & ‚ãØ & 1\\
    \cos Œ∏_1 & ‚ãØ & \cos Œ∏_n \\
    ‚ãÆ & ‚ã± & ‚ãÆ \\
    \cos (n-1)Œ∏_1 & ‚ãØ & \cos (n-1)Œ∏_n
\end{bmatrix}
$$


Here is a computer-based demonstration:
```julia
n = 10
Œ∏ = range(œÄ/(2n); step=œÄ/n, length=n) # n evenly spaced points starting at œÄ/(2n) with step size œÄ/n
C = Diagonal([1/sqrt(n); fill(sqrt(2/n), n-1)]) * [cos((k-1)*Œ∏[j]) for k=1:n, j=1:n]
C'C
```

**END**

**Problem 1.4 (B)**  A function with a jump does not have uniformly
converging coefficients. Plot interpolant for ${\rm sign}(Œ∏-1/2)$.
Conjecture where the approximation converges. (This is known as
Gibb's phenomena.) **Note** This is non-examinable as it is computer-based.

## 2. FFT 

**Problem 2.1‚ãÜ (B)** Show that $Q_{2n}$ can also be reduced to $Q_n$ applied
to two vectors.



## 3. Orthogonal polynomials

**Problem 3.1‚ãÜ  (B)** Construct  $p_0(x),p_1(x),p_2(x),p_3(x)$, monic OPs
for the weight $\sqrt{1-x^2}$ on $[-1,1]$.
Hint: first compute $\int_{-1}^1 x^k \sqrt{1-x^2} {\rm d} x$ for $0 ‚â§¬†k ‚â§¬†2$
using a change-of-variables.



**Problem 3.2‚ãÜ  (C, 3-term recurrence, 1st form)**
Show that if $\{p_n\}$ are OPs then there exist real constants $A_n ‚â† 0$, $B_n$, and $C_n$
such that
$$
\begin{align*}
p_1(x) &= (A_0 x + B_0) p_0(x) \\
p_{n+1}(x) &= (A_n x + B_n) p_n(x) - C_n p_{n-1}(x)
\end{align*}
$$
Write this as a lower triangular linear system, given $p_0(x) = Œº ‚àà ‚Ñù$:
$$
L_x \begin{bmatrix} p_0(x) \\ \vdots \\ p_{n-1}(x) \end{bmatrix} = \begin{bmatrix} Œº \\ 0 \\ ‚ãÆ \\ 0 \end{bmatrix}
$$


**Problem 3.3‚ãÜ  (B)** Show that if $f(x)$ is a degree $n-1$ polynomial
$$
f(x) = [p_0(x) | ‚ãØ | p_{n-1}(x)] \underbrace{\begin{bmatrix} c_0 \\ \vdots \\ c_{n-1} \end{bmatrix}}_{\bf c}
$$
then evaluation at a point can be recast as inverting an upper triangular system
(_Clenshaw's algorithm_):
$$
f(x) = Œºùêû_1^‚ä§ U_x^{-1} {\bf c}.
$$

**Problem 3.4‚ãÜ  (B)** If $w(-x) = w(x)$ for a weight supported on $[-b,b]$ show that $a_n = 0$.
Hint: first show that the (monic) polynomials $p_{2n}(x)$ are even and $p_{2n+1}(x)$ are odd.

**SOLUTION**

Note that $p_0(x)$ is even. $a_0$ is zero:
$$
‚ü®p_0,x p_0(x)‚ü© = \int_{-b}^b x w(x) {\rm d} x = 0
$$
which shows that
$$
p_1(x) = xp_0(x)
$$
is odd. We now proceed by induction. We have:
$$
‚ü®p_{2n},x p_{2n}(x)‚ü© = \int_{-b}^b x w(x) p_{2n}(x)^2 {\rm d} x = 0
$$
since $x w(x) p_{2n}(x)^2$ is odd$. Meanwhile. This show that if $p_{2n}$ and
$p_{2n-1}(x)$ is odd then
$$
p_{2n+1}(x) 
$$



**END**

